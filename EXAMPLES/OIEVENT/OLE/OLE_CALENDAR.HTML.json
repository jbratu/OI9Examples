{
    "record1": {
        "<1>": "\r\n\r\ndeclare function run_oecgi_request, Send_Message\r\nequ crlf$ to \\0D0A\\\r\n\r\n\r\nif Assigned(Param1) then p1 = Param1 else P1 = ''\r\nif Assigned(Param2) then p2 = Param2 else P2 = ''\r\nif Assigned(Param3) then p3 = Param3 else P3 = ''\r\nif Assigned(Param4) then p4 = Param4 else P4 = ''\r\nif Assigned(Param5) then p5 = Param5 else P5 = ''\r\nif Assigned(Param6) then p6 = Param6 else P6 = ''\r\nif Assigned(Param7) then p7 = Param7 else P7 = ''\r\nif Assigned(Param8) then p8 = Param8 else P8 = ''\r\nif Assigned(Param9) then p9 = Param9 else P9 = ''\r\nif Assigned(Param10) then p10 = Param10 else P10 = ''\r\n\r\n\r\n* Prevent endless loop when we redirect navigate\r\n\r\n\r\nmtext = 'OLE:':EventName\r\nmtext := ' p1=':P1\r\nmtext := ' p2=':P2\r\nmtext := ' p3=':P3\r\nmtext := ' p4=':P4\r\nmtext := ' p5=':P5\r\nmtext := ' p6=':P6\r\nmtext := ' p7=':P7\r\n\r\n\r\ncall Send_Event(@window:'.EVENTS', 'OMNIEVENT', mText)\r\n\r\n\r\n* Navigating to OI link?\r\n* Go Direct!\r\n\r\nif Get_Property(CtrlEntID,'@NAVIGATING' ) then\r\n\treturn 0\r\nend\r\n\t\r\nwas = Set_Property(CtrlEntId,'@NAVIGATING',1)\r\n\r\nBegin Case\r\n\r\n\tcase EventName _eqc 'BeforeNavigate2'\r\n\r\n\t\tmethod = .Rdo_Method->Value\r\n\t\turl = p2\r\n\t\tif method = 'O' and index(url, 'cgi.exe', 1) then\r\n\t\t\r\n\t\t\t* Cancel This Navigate\r\n\t\t\tParam7 = 1\r\n\t\t\tcall Forward_Event()\r\n\t\t\t\r\n\t\t\tDeclare function run_oecgi_request\r\n\t\t\tqpos = Index(url,'?',1)\r\n\t\t\tconvert '\\' to '/' in url\r\n\t\t\tif qpos then\r\n\t\t\t\tpath = url[1,qpos-1]\t\t\t\t\r\n\t\t\t\tproc = path[-1,'/']\r\n\t\t\t\targs = field(url, '?', 2 )\r\n\t\t\tend else\r\n\t\t\t\tproc = url[-1,'B/']\r\n\t\t\t\targs = ''\t\t\t\t\r\n\t\t\tend\r\n\t\t\t*\r\n\t\t\t* back door in Run_OECGI lets you pass in the function without it in the path\r\n\t\t\t*\r\n\t\t\tif index(args, '$SUBMIT',1 ) then\r\n\t\t\t\trequest = args\r\n\t\t\tend else\r\n\t\t\t\tif len(args) then\r\n\t\t\t\t \trequest = args :'&'\r\n\t\t\t\tend else\r\n\t\t\t\t\trequest = '' \t\r\n\t\t\t\tend\t\r\n\t\t\t\trequest:='$SUBMIT=PROC&PROC=' : proc\r\n\t\t\tend\r\n\t\t\tresult = run_oecgi_request( request )\r\n\t\t\t\r\n\t\t\t*\r\n\t\t\t* Need to set it directly\r\n\t\t\t* For now, write to flat file\r\n\t\t\t* \r\n\t\t\tfilename = 'result.htm'\r\n\t\t\toswrite result on filename\r\n\t\t\tCall Send_Message(CtrlEntId, 'Navigate2', 'file://' : filename )\r\n\t\t\t\r\n\t\tend\r\n\t\t\r\n\tCase 1\r\n\t\r\n\t\tCall Forward_Event()\r\n\t\t\r\nend case\r\n\r\nwas = Set_Property(CtrlEntId,'@NAVIGATING',0)\r\n\r\nreturn 0\r\n"
    }
}